schema: '2.0'
stages:
  extract_metadata:
    cmd:
    - echo "STAGE I"
    - rm data/dcm_metadata.csv || true
    - python src/data/extract_metadata.py
    deps:
    - path: data/dcm
      hash: md5
      md5: 776e4b24b55ef408ffd324a3e6cfcd57.dir
      size: 51636608570
      nfiles: 210
    - path: src/data/extract_metadata.py
      hash: md5
      md5: 93221105e879233bdb1dd812630b7b9b
      size: 4190
    outs:
    - path: data/dcm_metadata.csv
      hash: md5
      md5: 9b30138a835d12cfee681a96dfc0715e
      size: 35809
  convert_dicoms:
    cmd:
    - rm -rf data/sly_input_rgb || true
    - rm -rf data/sly_input_gray || true
    - python src/data/convert_dicoms.py to_gray=false save_dir=data/sly_input_rgb
    - python src/data/convert_dicoms.py to_gray=true save_dir=data/sly_input_gray
    deps:
    - path: data/dcm_metadata.csv
      hash: md5
      md5: 9b30138a835d12cfee681a96dfc0715e
      size: 35809
    - path: src/data/convert_dicoms.py
      hash: md5
      md5: 9bbc4995c7ea6c1b6c330f27d6783b2b
      size: 4496
    outs:
    - path: data/sly_input_gray
      hash: md5
      md5: df209b549a4c8d5726c2ac792a9c0c2e.dir
      size: 6279185933
      nfiles: 25698
    - path: data/sly_input_rgb
      hash: md5
      md5: 405e97e95a7138500e771dd69d56519b.dir
      size: 23240758188
      nfiles: 25698
  stack_images:
    cmd:
    - rm -rf data/sly_input || true
    - python src/data/stack_images.py output_type=video save_dir=data/sly_input
    deps:
    - path: data/sly_input_gray
      hash: md5
      md5: df209b549a4c8d5726c2ac792a9c0c2e.dir
      size: 6279185933
      nfiles: 25698
    - path: data/sly_input_rgb
      hash: md5
      md5: 405e97e95a7138500e771dd69d56519b.dir
      size: 23240758188
      nfiles: 25698
    - path: src/data/stack_images.py
      hash: md5
      md5: 72f001c3e0758d0d93f89d4dc5e03978
      size: 4802
    outs:
    - path: data/sly_input
      hash: md5
      md5: 80703f3dc0b23aec771aa09c9af38f42.dir
      size: 2161471795
      nfiles: 103
  convert_sly_to_int:
    cmd:
    - echo "STAGE II"
    - rm -rf data/interim || true
    - python src/data/convert_sly_to_int.py
    deps:
    - path: data/sly_output
      hash: md5
      md5: 0b4ede09c74a5e0e936bebad557d1ad0.dir
      size: 1367332522
      nfiles: 82
    - path: src/data/convert_sly_to_int.py
      hash: md5
      md5: 7880c46138f3252cb1bdfcd2622d0197
      size: 9125
    outs:
    - path: data/interim
      hash: md5
      md5: 64e36114dff4674dac1662144fc3d79f.dir
      size: 9000612457
      nfiles: 10206
  convert_int_to_cv:
    cmd:
    - rm -rf data/cv || true
    - python src/data/convert_int_to_cv.py
    deps:
    - path: data/interim
      hash: md5
      md5: 64e36114dff4674dac1662144fc3d79f.dir
      size: 9000612457
      nfiles: 10206
    - path: data/interim/metadata.csv
      hash: md5
      md5: 523d717ee45b51f200564d26a1ebbbcd
      size: 18283777
    - path: src/data/convert_int_to_cv.py
      hash: md5
      md5: 9848b0b7404b3c9e3c65b8aed96c6839
      size: 6959
    outs:
    - path: data/cv
      hash: md5
      md5: 8a501219b142a79e816c20c587bc3d15.dir
      size: 32248942241
      nfiles: 106621
